<div class="container">
  <div class="search-wrapper">
    <mat-icon class="search-icon" aria-hidden="true">search</mat-icon>
    <input
      type="text"
      id="search"
      name="search"
      [formControl]="searchControl"
      placeholder="Search by brand or model.."
    />
    @if (searchControl.value) {
    <button class="clear-btn" type="button" (click)="clearSearch()" aria-label="Clear search">
      <mat-icon>close</mat-icon>
    </button>
    }
  </div>

  <mat-form-field appearance="fill" class="sort-dropdown">
    <mat-select [(value)]="sortOption" (valueChange)="onSortChange($event)" disableRipple>
      <mat-option value="date_desc">Newest First</mat-option>
      <mat-option value="date_asc">Oldest First</mat-option>
      <mat-option value="price_asc">Price - Low to High</mat-option>
      <mat-option value="price_desc">Price - High to Low</mat-option>
    </mat-select>
  </mat-form-field>

  <div class="car-offers-list-wrapper">
    <div
      class="car-offers-list"
      [@listAnimation]
      infiniteScroll
      [infiniteScrollDistance]="2"
      [infiniteScrollThrottle]="100"
      (scrolled)="onScroll()"
    >
      @for (carOffer of carOffers; track carOffer._id) {
      <div class="car-offer-card" [@cardAnimation]>
        <app-car-offer-card [offer]="carOffer"></app-car-offer-card>
      </div>
      }@empty { @if(!isLoading && !initialLoad){
      <h3 class="car-offers-no-results">No results found</h3>
      } }
    </div>
  </div>

  @if (isLoading) {
  <mat-progress-spinner
    diameter="100"
    mode="indeterminate"
    color="primary"
    class="inline-spinner"
    [strokeWidth]="5"
  ></mat-progress-spinner>
  }
</div>
