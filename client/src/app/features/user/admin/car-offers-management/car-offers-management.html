<div class="container">
  <div class="search-wrapper">
    <mat-icon class="search-icon" aria-hidden="true">search</mat-icon>
    <input
      type="text"
      id="search"
      name="search"
      [formControl]="searchControl"
      placeholder="Search by brand or model.."
    />
    @if (searchControl.value) {
    <button class="clear-btn" type="button" (click)="clearSearch()" aria-label="Clear search">
      <mat-icon>close</mat-icon>
    </button>
    }
  </div>

  <mat-form-field appearance="fill" class="sort-dropdown">
    <mat-select [(value)]="sortOrder" (valueChange)="onSortChange($event)" disableRipple [placeholder]="'Sort by name'">
      <mat-option value="asc">Creation Date - Asc</mat-option>
      <mat-option value="desc">Creation Date - Desc</mat-option>
    </mat-select>
  </mat-form-field>

  <button mat-raised-button class="btn" (click)="goToAdd()">
    <mat-icon>add</mat-icon>
    Add Car Offer
  </button>
  <div class="car-offer-list-wrapper">
    <div
      class="car-offers-list"
      [@listAnimation]
      infiniteScroll
      [infiniteScrollDistance]="2"
      [infiniteScrollThrottle]="100"
      (scrolled)="onScroll()"
    >
      @for (carOffer of carOffers; track carOffer._id) {
      <div class="car-offer-card" [@cardAnimation]>
        <app-car-offer-card [offer]="carOffer"></app-car-offer-card>
        <div>
          <mat-icon
            style="color: #1976d2; margin-right: 10px; cursor: pointer"
            (click)="goToEdit(carOffer._id)"
            aria-label="Edit car offer"
            >edit</mat-icon
          >
          <mat-icon
            style="color: rgb(219, 0, 0); cursor: pointer"
            (click)="confirmDelete(carOffer)"
            aria-label="Delete car offer"
            >delete</mat-icon
          >
        </div>
      </div>
      } @empty { @if(!isLoading && !initialLoad){
      <h3 class="car-offers-no-results">No results found</h3>
      } }
    </div>
  </div>

  @if (isLoading) {
  <mat-progress-spinner
    diameter="100"
    mode="indeterminate"
    color="primary"
    class="inline-spinner"
    [strokeWidth]="5"
  ></mat-progress-spinner>
  }
</div>
